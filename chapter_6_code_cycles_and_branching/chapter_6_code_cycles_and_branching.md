# Глава 6: Циклы и ветвление кода

---

## Ветвление кода

Инструкции циклов и ветвления кода называют _управляющими инструкциями_, поскольку они позволяют управлять последовательностью выполнения программ JS.  
_Инструкции ветвления_ используются для создания различных путей выполнения программы в зависимости от логики условий.  
_Циклы_ — это простейший способ группирования JS-инструкций в программе.

При разработке логики JS-программ часто наступает момент, когда для определения дальнейшего пути выполнения требуется сделать определённый выбор.

---

## Инструкция `if...else`

Инструкции `if` и `else` работают совместно, вычисляя логическое выражение и выполняя различные инструкции в зависимости от результата.  
Инструкции `if` часто используются без инструкции `else`, тогда как последняя должна использоваться только совместно с инструкцией `if`.

### Синтаксис инструкции `if`

```javascript
if (условие) {
    // Код, который выполнится, если условие истинно
}
```

- _Условие_ — это любое выражение, вычисление которого даёт булево значение (`true` или `false`).
- Если результат вычисления выражения равен `true`, то выполняются инструкции, заключённые в фигурные скобки.
- Если результат равен `false`, то эти инструкции пропускаются.

### Инструкция `else`

Инструкция `else` используется для выполнения альтернативных действий, если результат вычисления условия равен `false`.

```javascript
var age = 17;
if (age < 18) {
    document.write('Продажа алкоголя несовершеннолетним запрещена.');
} else {
    document.write('Чем это закончится?');
}
```

---

## Инструкция `else if`

В JavaScript отсутствует ключевое слово `else...if`, но его функциональность реализуется с помощью последовательных инструкций `else if`:

```javascript
if (time < 12) {
    document.write('Доброе утро!');
} else if (time < 17) {
    document.write('Добрый день!');
} else if (time < 20) {
    document.write('Добрый вечер!');
} else {
    document.write('Доброй ночи!');
}
```

---

## Сокращённая запись инструкции `if...else`

### Тернарный оператор

Тернарный оператор позволяет записать инструкцию `if...else` в компактной форме:

```javascript
var whatToSay = time < 12 ? 'Доброе утро!' : 'Привет!';
```

- Если `time` меньше 12, переменная `whatToSay` получает значение `"Доброе утро!"`.
- В противном случае она получает значение `"Привет!"`.

---

### Использование оператора `&&`

Оператор "Логическое И" (`&&`) можно использовать для сокращённой записи, если требуется выполнить действие только при выполнении условия.

```javascript
time < 12 && document.write('Доброе утро!');
```

- Если `time < 12`, то в HTML-документ будет записана строка `"Доброе утро!"`.
- Если условие не выполняется, ничего не произойдёт.

> **Примечание:** Этот метод используется нечасто, так как его смысл может быть неочевиден для начинающих программистов.

Обратите внимание на использование символов разрыва строки и пробела в предыдущих примерах. Каждый программист волен самостоятельно выбирать наиболее удобный с его точки зрения стиль форматирования инструкций `if...else`. Вы могли видеть их записанными с использованием большего или меньшего количества строк или без пробелов между ключевыми словами и скобками. Все эти способы равноценны. Однако в любом случае следует всегда ставить во главу угла удобочитаемость кода, а не его компактность.

---

## Инструкция `switch`

Инструкция `switch` (_переключатель_) позволяет выбрать, какая из нескольких инструкций должна быть выполнена, исходя из возможных значений заданного выражения. Каждое из таких значений называется _вариантом_ (case).

На обычном языке работу этой инструкции можно описать примерно так:  
"В том случае, если ожидается 6 гостей, заказать три пиццы. Если ожидается 12 гостей, то заказать 6 пицц. Если же ожидается более 20 гостей, то сойти с ума".

### Синтаксис инструкции `switch`

```javascript
switch (выражение) {
    case Значение1:
        // Инструкции
        break;
    case Значение2:
        // Инструкции
        break;
    case Значение3:
        // Инструкции
        break;
    default:
        // Инструкции
        break;
}
```

Обратите внимание на инструкцию `break`, которая указывается вслед за каждой группой инструкций, соответствующей определенному варианту. Каждая такая инструкция `break` обеспечивает прекращение выполнения инструкции `switch` и выход за ее пределы. В случае отсутствия инструкции `break` инструкция `switch` продолжит свою работу и выполнит операторы следующего варианта, независимо от того, совпадает ли указанное в нем значение со значением выражения, указанного в начале инструкции `switch`.

Отсутствие инструкций `break` в инструкции `switch` чревато проблемами, о чем вам никогда не следует забывать. Если после выполнения инструкций варианта, удовлетворяющего условию инструкции `switch`, окажется, что инструкция `break` отсутствует, то начнется выполнение инструкций следующего варианта, что может приводить к непредсказуемым последствиям. Порожденные этим проблемы нелегко обнаружить, поскольку обычно они приводят не к ошибкам, а к некорректным результатам.

Если ни для одного из предложений `case` совпадений со значением выражения не найдено, то инструкция `switch` осуществляет поиск варианта `default` и выполняет содержащиеся в нем инструкции.

Единственный случай, когда инструкция `break` может безболезненно опущена, относится к варианту `default`, указанному последним среди всех остальных (как и должно быть), поскольку вслед за инструкцией `switch` выполнение программы продолжается в любом случае.

### Пример использования инструкции `switch`

```javascript
var languagePreference = 'испанский';
switch (languagePreference) {
    case 'английский':
        console.log('Hello!');
        break;
    case 'испанский':
        console.log('Hola!');
        break;
    case 'немецкий':
        console.log('Guten Tag!');
        break;
    case 'французский':
        console.log('Bonjour!');
        break;
    default:
        console.log('Извините, я не знаю ' + languagePreference + ' язык!');
}
```

---

## Циклы

_Циклы_ предназначены для многократного выполнения одного и того же набора инструкций. В JavaScript возможны циклы нескольких видов:

- `for`
- `for...in`
- `do...while`
- `while`

---

### Цикл `for`

Инструкция `for` создает цикл с использованием трех выражений:

- **Инициализация.** Инициализация переменной, обычно — счетчика.
- **Условие.** Булево выражение, которое вычисляется на каждой итерации цикла.
- **Завершающее выражение.** Выражение, которое вычисляется по завершении каждой итерации цикла.

Несмотря на то что любое из этих выражений может быть опущено, в инструкцию почти всегда включают все три выражения. Обычно цикл `for` используется для выполнения кода несколько раз.

#### Пример использования цикла `for`

```javascript
for (var x = 1; x < 10; x++) {
    console.log(x);
}
```

Рассмотрим выполнение этого цикла более подробно:

1. **Переменная, в данном случае `x`, инициализируется значением 1.**
2. **Осуществляется проверка того, что `x` меньше `10`.**
   - Если это так, то выполняются инструкции тела цикла (в данном случае — инструкция `console.log`).
3. **Значение `x` увеличивается на `1` с помощью оператора инкремента (`++`).**
4. **Вновь осуществляется проверка того, что `x` меньше `10`.**
5. **Проверка повторяется до тех пор, пока результат вычисления выражения условия не станет ложным.**

#### Перечисление элементов массива в цикле

Циклы можно использовать для перечисления содержимого массива, сравнивая значение счетчика со значением свойства `length` массива. При этом нельзя забывать о том, что в JS отсчет индексов начинается с нуля и что значение `array.length` всегда на единицу больше наивысшего значения индекса элемента в массиве.

```html
<html>
    <head>
        <title>Другие телефонные коды</title>
    </head>
    <body>
        <script>
            var areaCodes = [
                '770',
                '404',
                '718',
                '202',
                '901',
                '305',
                '312',
                '313',
                '215',
                '803'
            ];
            for (var x = 0; x < areaCodes.length; x++) {
                document.write('Другой телефонный код: ' + areaCodes[x] + '<br>');
            }
        </script>
    </body>
</html>
```

---

### Цикл `for...in`

Цикл `for...in` перебирает все свойства объекта. Его также можно использовать для перебора всех элементов массива, однако для массивов предпочтительнее использовать обычный цикл `for`.

Цикл `for...in` имеет одну интересную особенность: он не гарантирует порядок перебора свойств объекта или элементов массива. По этой причине, а также потому, что цикл `for...in` работает медленнее, для работы с массивами лучше использовать стандартный цикл `for`.

Объекты — это контейнеры данных, имеющие свойства (которые определяют, что собой представляет данный объект) и методы (которые определяют, что может делать объект). В браузерах имеются наборы встроенных объектов, которые программисты могут использовать для того, чтобы управлять поведением браузера. Из них наиболее общим типом объекта является `Document`. В частности, с помощью метода `write()` этого объекта вы можете приказать браузеру вставить заданное значение в HTML-документ.

В объекте `Document` имеются также свойства, которые он использует для отслеживания информации в текущем документе и передачи ее программисту. Например, коллекция `Document.images` содержит информацию о всех тегах `img` текущего HTML-документа.

#### Перечисление свойств объекта `Document` с помощью цикла `for...in`

```html
<html>
    <head>
        <title>Свойства документа</title>
        <style>
            .columns {
                -webkit-column-count: 6; /* Chrome, Safari, Opera */
                -moz-column-count: 6;    /* Firefox */
                column-count: 6;
            }
        </style>
    </head>
    <body>
        <div class="columns">
            <script>
                for (var prop in document) {
                    document.write(prop + '<br>');
                }
            </script>
        </div>
    </body>
</html>
```

Вы также можете использовать цикл `for...in` для вывода значений свойств объекта, а не только их имен.

#### Вывод имен и значений свойств объекта `Document` с помощью цикла `for...in`

```html
<html>
    <head>
        <title></title>
        <style>
            .columns {
                -webkit-column-count: 6; /* Chrome, Safari, Opera */
                -moz-column-count: 6;    /* Firefox */
                column-count: 6;
            }
        </style>
    </head>
    <body>
        <div class="columns">
            <script>
                for (var prop in document) {
                    document.write(prop + ': ' + document[prop] + '<br>');
                }
            </script>
        </div>
    </body>
</html>
```

---

### Цикл `while`

Инструкция `while` создает цикл, который выполняется до тех пор, пока вычисление выражения, устанавливающего условие выполнения цикла, дает истинное значение.

#### Использование цикла `while`

```html
<html>
    <head>
        <title>Игра в слова</title>
    </head>
    <body>
        <script>
            var guessedWord = prompt('Какое слово я задумал?');
            while (guessedWord != 'сэндвич') {
                guessedWord = prompt('Нет. Это не оно. Попробуйте еще раз.');
            }
            alert('Поздравляю! Это именно то слово!');
        </script>
    </body>
</html>
```

---

### Цикл `do...while`

Цикл `do...while` во многом работает точно так же, как и цикл `while`, за исключением того, что в данном случае инструкции предшествуют проверке условия. Как следствие, данный вид цикла всегда выполняется по крайней мере один раз.

#### Использование цикла `do...while`

```html
<html>
    <head>
        <title>Давайте посчитаем</title>
    </head>
    <body>
        <script>
            var i = 0;
            do {
                i++;
                document.write(i + '<br>');
            } while (i < 10);
        </script>
    </body>
</html>
```

---

### Инструкции `break` и `continue`

Инструкции `break` и `continue` прерывают выполнение цикла. Мы уже рассматривали инструкцию `break` в контексте инструкции `switch`, где она использовалась для продолжения программы после выполнения подходящего варианта.

- Инструкция `break` в циклах приводит к немедленному выходу из тела цикла, независимо от того, выполняется или не выполняются условия для продолжения выполнения цикла.

#### Использование инструкции `break` в цикле `while`

```html
<html>
  <head>
    <title>Игра в слова</title>
  </head>
  <body>
    <script>
      var guessedWord = prompt("Какое слово я задумал?");
      while (guessedWord != "сэндвич") {
        if (guessedWord == "") {
          break;
        }
        // Немедленно выйти из цикла, если пользователь не ввел значение
        guessedWord = prompt("Нет. Это не оно. Попробуйте еще раз.");
      }
      alert("Поздравляю! Это именно то слово!");
    </script>
  </body>
</html>
```

- Когда встречается инструкция `continue`, выполнение текущей итерации прекращается, инструкции цикла, следующие за инструкцией `continue`, игнорируются, и начинается выполнение следующей итерации цикла.

#### Счет и использование инструкции `continue` для отображения четных чисел

```html
<html>
    <head>
        <title>Счет и отображение четных чисел</title>
    </head>
    <body>
        <script>
            for (var i = 0; i <= 20; i++) {
                if (i % 2 != 0) {
                    continue;
                }
                document.write(i + ' - четное число.<br>');
            }
        </script>
    </body>
</html>
```

Если инструкция `continue` используется таким способом, то она может заменять собой инструкцию `else`.

Инструкции `break` и `continue` могут быть не только полезными, но и небезопасными. Они короткие, и их можно легко пропустить при чтении кода. Поэтому некоторые программисты считают их использование в цикле небезопасной практикой.

---
